@inject ToastService ToastService

<div id="toast" class="@BackgroundCssClass">
    <div id="img" class="@Mode">
        <Blazicon Svg="@IconSvg"></Blazicon>
    </div>
    <div id="desc">
        <span>@Message</span>
    </div>
</div>

@code
{

    protected string Message { get; set; } = "";
    protected bool IsVisible { get; set; }
    public string BackgroundCssClass { get; set; } = "";
    protected SvgIcon IconSvg { get; set; } = Lucide.ThumbsUp;

    public string Mode { get; set; } = "";

    protected override void OnInitialized()
    {
        ToastService.OnShow += ShowToast;
        ToastService.OnHide += HideToast;
    }

    private async void ShowToast(string message, ToastLevel level)
    {
        BuildToastSettings(level, message);    
        IsVisible = true;
        await InvokeAsync(StateHasChanged);
    }

    private async void HideToast()
    {
        BackgroundCssClass = "";
        Mode = "";
        IconSvg = Lucide.ThumbsUp;
        IsVisible = false;
        await InvokeAsync(StateHasChanged);
    }

    private void BuildToastSettings(ToastLevel level, string message)
    {
        (Mode, IconSvg) = level switch
        {
            ToastLevel.Success => ("success", Lucide.ThumbsUp),
            ToastLevel.Error => ("error", Lucide.X),
            _ => ("success", Lucide.ThumbsUp)
        };
        Message = message;
        BackgroundCssClass = $"{Mode} show";
    }

    public void Dispose()
    {
        ToastService.OnShow -= ShowToast;
        ToastService.OnHide -= HideToast;
    }
}